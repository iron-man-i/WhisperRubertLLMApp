# WhisperRubertLLMApp
SpeechToText (STT) OpenAI Whisper --> Rubert (Positive-Neutral-Negative) --> LLM (Deepseek) recommendations to improve. Application with Streamlit. 

## Распознавание текста из аудио, анализ тональности текста, рекомендации по улучшению диалога от ИИ. Работает через Streamlit.

Видео с демонстрацией работы приложения находится по этой ссылке:

https://cloud.mail.ru/public/a3ao/FrbQYvqEu

Docker файл находится по этой ссылке:

https://cloud.mail.ru/public/ZqaT/2EqD6avbx

## Описание
Это веб-приложение на основе Streamlit, которое выполняет следующие функции:
1. **Распознавание речи**: Транскрибирует аудиофайл (WAV, MP3) в текст с использованием модели Whisper.
2. **Анализ тональности**: Определяет тональность распознанного текста (Позитивный, Негативный, Нейтральный) с помощью модели RuBERT.
3. **Рекомендации по улучшению**: Генерирует рекомендации по улучшению разговора с использованием Deepseek LLM через API.
4. **Сохранение результатов**: Сохраняет распознанный текст в файл `transcription.txt` и предоставляет возможность его скачать.

## Выбранные модели
### 1. Whisper (medium)
- **Название**: `openai/whisper-medium`
- **Описание**: Модель для автоматического распознавания речи, оптимизированная для русского языка. Средний размер обеспечивает баланс между точностью и скоростью.
- **Ссылка**: [Hugging Face - Whisper](https://huggingface.co/openai/whisper-medium)
- **Использование**: Транскрипция аудиофайлов в текст.

### 2. RuBERT для анализа тональности
- **Название**: `blanchefort/rubert-base-cased-sentiment`
- **Описание**: Модель на основе RuBERT, дообученная для анализа тональности русского текста. Поддерживает три класса: Позитивный, Негативный, Нейтральный.
- **Ссылка**: [Hugging Face - RuBERT](https://huggingface.co/blanchefort/rubert-base-cased-sentiment)
- **Использование**: Классификация тональности распознанного текста.

### 3. Deepseek LLM
- **Название**: `deepseek-chat`
- **Описание**: Модель для генерации текста, доступная через API Deepseek. Используется для создания рекомендаций по улучшению разговора на основе транскрипции.
- **Ссылка**: ([https://api.deepseek.com](https://platform.deepseek.com/api_keys))
- **Использование**: Генерация рекомендаций по улучшению коммуникации.

## Требования
- Python 3.8+
- FFmpeg (установлен и доступен в PATH или указан путь к `ffmpeg.exe`)
- Библиотеки Python:
  ```bash
  pip install streamlit pywhispercpp transformers torch ffmpeg-python numpy requests
  ```
- API-ключ Deepseek (получите на [Deepseek](https://platform.deepseek.com/) и задайте через переменную окружения `DEEPSEEK_API_KEY` или в интерфейсе приложения).

## Установка и запуск
1. **Установите FFmpeg**:
   - Скачайте FFmpeg с [официального сайта](https://ffmpeg.org/download.html). Или с этого сайта: https://www.gyan.dev/ffmpeg/builds/ffmpeg-release-full.7z
   - Добавьте путь к `ffmpeg.exe` в PATH или укажите его в коде (переменная `ffmpeg_path`).

2. **Установите зависимости**:
   ```bash
   pip install streamlit pywhispercpp transformers torch ffmpeg-python numpy requests
   ```

3. **Сохраните код**:
   - Сохраните код в файл `speech_to_sentiment_app.py`.

4. **Задайте API-ключ Deepseek** (один из вариантов):
   - Установите переменную окружения:
     ```bash
     export DEEPSEEK_API_KEY="ваш_ключ"
     ```
   - Или введите ключ в интерфейсе приложения (в боковой панели).

5. **Запустите приложение**:
   ```bash
   streamlit run speech_to_sentiment_app.py
   ```
   - Приложение откроется в браузере по адресу `http://localhost:8501`.

6. **Использование**:
   - Загрузите аудиофайл (WAV или MP3).
   - Введите API-ключ Deepseek (если не задан в окружении).
   - Нажмите кнопку "Распознать и проанализировать".
   - Результаты: распознанный текст, тональность и рекомендации от Deepseek.

## Ограничения
- **Whisper**:
  - Требуется FFmpeg для обработки аудио.
  - Точность транскрипции зависит от качества аудио и выбранной модели (medium может быть менее точной, чем large).
  - Поддерживаются только WAV и MP3.
- **RuBERT**:
  - Максимальная длина текста — 512 токенов. Длинные тексты разбиваются на части, что может повлиять на точность анализа.
  - Модель оптимизирована для русского языка, но может быть менее точной на диалектах или неформальной речи.
- **Deepseek**:
  - Требуется API-ключ и интернет-соединение.
  - Качество рекомендаций зависит от качества транскрипции и контекста.
- **Производительность**:
  - Требуется достаточно мощное оборудование для быстрой обработки (особенно для модели Whisper).
  - Первая загрузка моделей может занять время из-за скачивания с Hugging Face.

## Что можно улучшить при большем времени
- **Whisper**:
  - Перейти на модель `large` для повышения точности транскрипции.
  - Добавить поддержку других аудиоформатов (например, FLAC, OGG) через FFmpeg.
- **RuBERT**:
  - Использовать модель с поддержкой более длинных последовательностей (например, Longformer для русского языка).
  - Добавить постобработку текста для улучшения качества анализа (удаление шумов, нормализация).
- **Deepseek**:
  - Настроить параметры API (например, `temperature`, `max_tokens`) для более точных рекомендаций.
  - Добавить кэширование запросов к API для ускорения.
- **Интерфейс**:
  - Добавить историю анализа (сохранение предыдущих транскрипций и результатов).
  - Реализовать визуализацию тональности (например, график распределения меток по фрагментам текста).
- **Производительность**:
  - Оптимизировать загрузку моделей с помощью кэширования (`@st.cache_resource` уже используется, но можно улучшить).
  - Реализовать асинхронную обработку для ускорения работы с API.

# Контакты: Telegram: @Aleksey_Iron


